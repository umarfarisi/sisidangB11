<!DOCTYPE html>
<html>
<head>
	<title>Jadwal Sidang</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<style type="text/css">
		#containers-nav-button{
			max-width: 1600px;
	  		margin: 10px auto;
	  		padding: 0px
		}
	  	.containers{
	  		max-width: 1600px;
	  		margin: 10px auto;
	  	}
	  	#total-row{
	  		background-color: gray;
	  		color: white;
	  	}
	  	#total-row p{
	  		padding-top: 10px;
	  		padding-bottom: 10px;
	  		padding-left: 10px;
	  		font-size: 20px;
	  	}
	  	.nav-button{
	  		width: 50%
	  		margin-right:5px;
	  		margin-left:5px;
	  	}
	</style>
	<script type="text/javascript">
		$ ( document ). ready ( function (){

			var countPref = new Array(0);
			var start = 0;
			var nextNav = false;
			var prefNav = false;

			navigationSetting(start, true);

			$("#nav-next-btn").click(function(){
				start += countPref[countPref.length-1];
				navigationSetting(start, true);
			});
			$("#nav-pref-btn").click(function(){
				start -= countPref[countPref.length-2];
				countPref.pop();
				navigationSetting(start, false);
			});

			function navigationSetting(start, isNext){

				var url = "http://localhost/sisidangB11/jadwal_sidang/dosen.php";
				$.ajax({
					type : 'POST',
					url : url,
					dataType : 'text',
					data : {
						start: start,
						username: sessionStorage.getItem("user")
					},
					success : function(results){
						var data = JSON.parse(results);
						// console.log(results);
						// alert(results);
						if(data.result === "sukses"){
							var rows = data.data;
							if(isNext){
								countPref.push(data.count);

								if(data.count > 9){
									countPref.pop();
									countPref.push(9);
									nextNav = true;
								}else{
									nextNav = false;
								}
							}else{
								nextNav = true;
							}

							$("#total-row p span").html(" countPref: "+countPref[countPref.length-1]+" Start: "+start+" countPref.Length: "+countPref.length);

							prefNav = start !== 0;

							if(nextNav){
								$("#nav-next-btn").css("display","inline-block");
							}else{
								$("#nav-next-btn").css("display","none");
							}
							if(prefNav){
								$("#nav-pref-btn").css("display","inline-block");
							}else{
								$("#nav-pref-btn").css("display","none");
							}

							$("#table-jadwal-sidang").empty();
							$("#table-jadwal-sidang").append("<tr>"
									+"<th>Mahasiswa</th>"
									+"<th>Jenis Sidang</th>"
									+"<th>Judul</th>"
									+"<th>Waktu dan Lokasi</th>"
									+"<th>Pembimbing Lain</th>"
									+"<th>Status</th>"
									+"</tr>");


							for(var i = 0 ; i < rows.length && i < 9 ; i++){
								var mahasiswa = rows[i].nama;
								var jenisSidang = rows[i].namamks;
								var judul = rows[i].judul;
								var waktuDanLokasi = rows[i].tanggal+" || "+rows[i].jam_mulai+"-"+rows[i].jam_selesai+" || "+rows[i].namaruangan;
								var pembimbingLain = "";
								for(var j = 0 ; j < rows[i].pembimbing_lain.length ; j++){
									pembimbing_lain += rows[i].pembimbing_lain[j];
									if(j !== rows[i].pembimbing_lain.length){
										pembimbing_lain += ", ";
									}
								}
								var status = "";
								if(rows[i].issiapsidang === "t"){
									status += "Siap Sidang, ";
								}
								if(rows[i].ijinmajusidang  === "t"){
									status += "Ijin Maju Sidang, ";
								}
								if(rows[i].pengumpulanhardcopy === "t"){
									status += "Pengumpulan Hard Copy, ";
								}
								$("#table-jadwal-sidang").append(""
									+"<tr>"
									+"<td>"+mahasiswa+"</td>"
									+"<td>"+jenisSidang+"</td>"
									+"<td>"+judul+"</td>"
									+"<td>"+waktuDanLokasi+"</td>"
									+"<td>"+pembimbingLain+"</td>"
									+"<td>"+status+"</td>"
									+"</tr>");
							}


						}else{

						}
					},
					error : function(a,error,z){
						alert("Login error "+error);
					}
				});
			}
		});
	</script>
</head>
<div><h1>Jadwal Sidang Mahasiswa</h1></div>
<body>
	<table class="table table-hover containers" id="table-jadwal-sidang">
<!-- 		<tr>
			<th>Mahasiswa</th>
			<th>Jenis Sidang</th>
			<th>Judul</th>
			<th>Waktu dan Lokasi</th>
			<th>Pembimbing Lain</th>
			<th>Status</th>
		</tr> -->

	</table>
	<div id="total-row" class="containers">
		<p><span></span></p>
	</div>
	<div id="containers-nav-button" >
		<button id="nav-pref-btn" class="btn btn-primary nav-button">Sebelumnya</button>
		<button id="nav-next-btn" class="btn btn-primary nav-button">Selanjutnya</button>
	</div>
</body>
</html>
